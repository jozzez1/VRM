\documentclass[a4 paper, 12pt]{article}
\usepackage[slovene]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[small, width=0.8\textwidth]{caption}
\usepackage[pdftex]{graphicx}
\usepackage{amssymb, amsmath, fullpage, float, hyperref, stackrel}

\begin{document}

\begin{center}
\textsc{Višje računske metode}\\
\textsc{2012/13}\\[0.5cm]
\textbf{4. naloga -- Kubitne verige}
\end{center}
\begin{flushright}
\textbf{Jože Zobec}
\end{flushright}

\newcommand{\e}{
	\ensuremath{\text{e}}
}

\section{Uvod}

Oznake in definicije bodo iste, kot so v skripti.

V tej nalogi imamo propagacijo po času, kot tudi po temperaturi (imaginarnem času).

Ker bomo imeli opravka z veliko množenji, matrika pa je le dimenzije $4 \times 4$ in je simetrična tridiagonalna
itd. se splača to transformacijo zakodirati naravnost v kodo. Če moramo transformirati vektor
$\underline{x} = (x_0, x_1, x_2, x_3)^T$, se ta po propagaciji s kompleksnim koeficientom $\alpha$ za kompleksni korak
$z$ transformira tako:

\begin{equation}
	\begin{bmatrix}
		x_0 \\
		x_1 \\
		x_2 \\
		x_3
	\end{bmatrix} \stackrel{U^{(2)}(\alpha z)}{\longrightarrow} \text{e}^{-\alpha z}
	\begin{bmatrix}
		\exp(2\alpha z) x_0 \\
		\cosh(2\alpha z)x_1 + \sinh(2\alpha z)x_2 \\
		\sinh(2\alpha z)x_1 + \cosh(2\alpha z)x_2 \\
		\exp(2\alpha z) x_3
	\end{bmatrix}.
	\label{eqn:U}
\end{equation}

Temperaturni propagator je $\sim \exp(-\beta H)$, in časovni je $\sim \exp (-itH)$, kjer sta $\beta$ in $t$ realni
količini\footnote{$t$ -- brezdimenzijski čas, $\beta$ -- recipročna brezdimenzijska temperatura}. Odtod vidimo, da
je $z$ čisto imaginarno število za čas in čisto realno število za temperaturni premik. Oz. drugače povedano

\[
	|\psi(t)\rangle = \e^{-itH}, \qquad |\psi(-i\beta)\rangle = \e^{-\beta H}.
\]

\subsection{Hamiltonian}

Propagator smo dobili tako, da smo Hamiltonian razcepili na operatorja $A$ in $B$, eden delce "`prime"' na sodih,
drugi pa na lihih mestih. Če to matriko zapišemo zgolj za dvodelčno stanje, lahko hamiltonian zapišemo s pomočjo
matrike $A^{(2)}$, ki sedaj deluje le na enem paru fermionov:

\[
	A^{(2)} = \begin{bmatrix}
		1 &  &  &  \\
		&-1 &\ 1 &  \\
		 & \quad 1 & -1 &  \\
		 &  &  & 1
		\end{bmatrix},
\]

kjer moramo s to matriko izmenično delovati na pare fermionov -- enkrat na vse sode, drugič na vse lihe. Hamiltonian
ima še dele, s katerim delujemo na lihe. Radi bi ga zapisali v isti bazi, kot $A^{(2)}$, da ga bomo lahko sešteli
in tako imeli le en Hamiltonski blok za dva kubita. Ker prime le lihe in imamo periodične robne pogoje, vidimo, da je
$B^{(2)}$ seveda

\[
	B^{(2)} = \begin{bmatrix}
		-1 & & & 1 \\
		& 1 & & \\
		& & 1 & \\
		1 & & & -1
		\end{bmatrix},
\]

kar lahko z nekaj algebre potrdimo. Po definiciji mora veljati

\begin{equation}
	H^{(2)} = A^{(2)} + B^{(2)} = \begin{bmatrix}
		& & & 1 \\
		& & 1 & \\
		& 1 & & \\
		1 & & &
		\end{bmatrix}.
\end{equation}

Matriko $H^{(2)}$ lahko diagonaliziramo in dobimo, da so lastne vrednosti $\lambda_{1,2} = 1$ in $\lambda_{3,4} = -1$.
Če je naša numerična simulacija pravilna, moramo dobiti torej dobiti $\langle H \rangle_\beta
\stackrel{\beta \to \infty}{\longrightarrow} -1$. Vse daljše kubitne verige bodo zaradi tega prav tako imele osnovno
energijo $E_0 = -1$. Vendar pa večji hamiltoniani NISO bločno diagonalni. Če namreč seštejemo $B^{(3)}$ in $A^{(3)}$ ne
dobimo bločno diagonalno, ampak razpršeno matriko, ker ima $B^{(3)}$ neničelne stranske bloke, zaradi periodičnih robnih
pogojev na verigi. Hamiltonian za trodelčno verigo se glasi

\begin{equation}
	H^{(3)} = \begin{bmatrix}
	0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 \\
	0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 \\
	0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 \\
	0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 \\
	0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 \\
	1 & 0 & 0 & 0 & 0 & 0 & 0 & 0
	\end{bmatrix}.
\end{equation}

Ta matrika posplošitev prejšnje. Robni pogoji dajo na najbolj izvendiagonalnih robovih matrike enice, ob diagonali pa
se s periodo 2 ponavljata enici. Lahko napovem, da je $H^{(4)}$ taka, da prvi obdiagonali podaljšamo do matrike ranga
16, tista priveska na robovih pa enostavno premaknemo do pravega roba.

Ta matrika zgolj premeša naše komponente vektorja $\underline{x}$. Paroma jih zamenja, začenši pri $x_1$ upoštevaje
robne pogoje na koncu. Tako delovanje $H^{(3)}$ naredimo zgolj v enem koraku, brez seštevanj in dodatnih numeričnih
napak, ki bi pri tem nastale.

\[
	\begin{bmatrix}
	x_0 \\
	x_1 \\
	x_2 \\
	x_3 \\
	x_4 \\
	x_5 \\
	x_6 \\
	x_7
	\end{bmatrix} \stackrel{H^{(3)}}{\longrightarrow}
	\begin{bmatrix}
	x_7 \\
	x_2 \\
	x_1 \\
	x_4 \\
	x_3 \\
	x_6 \\
	x_5 \\
	x_0
	\end{bmatrix}
\]

V bistvu ta matrika vse komponente z lihim indeksom premakne za eno naprej v sodi indeks, vse lihe pa za eno nazaj,
v njim pripadujoči lihi indeks. Ko vemo to, lahko program še bolj zoptimiziramo, tako da nam sploh ni treba računati
$|\chi\rangle = H |\psi\rangle$, ampak lahko kar takoj zapišemo kakšen je tak skalaren produkt. Za vektor
$\underline{x}$ dimenzije $N$ je

\begin{equation}
	\underline{x}^\dagger H \underline{x} = 2\sum_{j = 0}^{N/2 - 1} = x^\dagger_{2j}x_{2j-1}, \quad x_{-1} = x_N.
\end{equation}

za kubitno verigo dolžine 3 to pomeni

\[
	\underline{x}^\dagger H \underline{x} = 2 (x_0^* x_7 + x_2^* x_1 + x_4^*x_3 + x_6^*x_5).
\]

Predpostavka, o obliki Hamiltoniana ter skalarnem množenju se je po neumeričnem testu izkazala resnično, optimizacija
pomeni več prostega spomina ter hitrejše delovanje.

Ker so komponente $x_j$ nekorelirana kompleksna števila, pomeni da bomo na začetku imeli majhen delež imaginarne
energije, ki pa bi moral eksponentno hitro izzveneti -- numerični eksperiment je to potrdil, kar se na grafih lepo vidi.
Hitrost izzvenevanja je odvisna od izbire integratorja.
Energija se cilju približuje potenčno, naklon se da določiti iz prilagajanja.

\end{document}

